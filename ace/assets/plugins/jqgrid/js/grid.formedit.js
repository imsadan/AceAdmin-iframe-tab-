(function(a){if(typeof define==="function"&&define.amd){define(["jquery","./grid.base","./grid.common"],a)}else{a(jQuery)}}(function(a){var b={};a.jgrid.extend({editGridRow:function(g,e){var f=a.jgrid.getRegional(this[0],"edit"),d=this[0].p.styleUI,h=a.jgrid.styleUI[d].formedit,c=a.jgrid.styleUI[d].common;e=a.extend(true,{top:0,left:0,width:"500",datawidth:"auto",height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},processing:false,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:true,overlayClass:c.overlay,removemodal:true,form:"edit",template:null,focusField:true},f,e||{});b[a(this)[0].p.id]=e;return this.each(function(){var i=this;if(!i.grid||!g){return}var I=i.p.id,B="FrmGrid_"+I,F="TblGrid_"+I,D="#"+a.jgrid.jqID(F),E,J={themodal:"editmod"+I,modalhead:"edithd"+I,modalcontent:"editcnt"+I,scrollelm:B},U=true,K=1,L=0,O,w,C,X=typeof b[i.p.id].template==="string"&&b[i.p.id].template.length>0,y=a.jgrid.getRegional(this,"errors");b[i.p.id].styleUI=i.p.styleUI||"jQueryUI";if(a.jgrid.isMobile()){b[i.p.id].resize=false}if(g==="new"){g="_empty";C="add";e.caption=b[i.p.id].addCaption}else{e.caption=b[i.p.id].editCaption;C="edit"}if(!e.recreateForm){if(a(i).data("formProp")){a.extend(b[a(this)[0].p.id],a(i).data("formProp"))}}var s=true;if(e.checkOnUpdate&&e.jqModal&&!e.modal){s=false}function H(){var ab={},ac;a(D).find(".FormElement").each(function(){var ae=a(".customelement",this);if(ae.length){var af=ae[0],ag=a(af).attr("name");a.each(i.p.colModel,function(){if(this.name===ag&&this.editoptions&&a.isFunction(this.editoptions.custom_value)){try{O[ag]=this.editoptions.custom_value.call(i,a("#"+a.jgrid.jqID(ag),D),"get");if(O[ag]===undefined){throw"e1"}}catch(aj){if(aj==="e1"){a.jgrid.info_dialog(y.errcap,"function 'custom_value' "+b[a(this)[0]].p.msg.novalue,b[a(this)[0]].p.bClose,{styleUI:b[a(this)[0]].p.styleUI})}else{a.jgrid.info_dialog(y.errcap,aj.message,b[a(this)[0]].p.bClose,{styleUI:b[a(this)[0]].p.styleUI})}}return true}})}else{switch(a(this).get(0).type){case"checkbox":if(a(this).is(":checked")){O[this.name]=a(this).val()}else{var ah=a(this).attr("offval");O[this.name]=ah}break;case"select-one":O[this.name]=a("option:selected",this).val();break;case"select-multiple":O[this.name]=a(this).val();if(O[this.name]){O[this.name]=O[this.name].join(",")}else{O[this.name]=""}var ai=[];a("option:selected",this).each(function(aj,ak){ai[aj]=a(ak).text()});break;case"password":case"text":case"textarea":case"button":O[this.name]=a(this).val();break;case"radio":if(ab.hasOwnProperty(this.name)){return true}else{ab[this.name]=(a(this).attr("offval")===undefined)?"off":a(this).attr("offval")}break}if(i.p.autoencode){O[this.name]=a.jgrid.htmlEncode(O[this.name])}}});for(ac in ab){if(ab.hasOwnProperty(ac)){var ad=a('input[name="'+ac+'"]:checked',D).val();O[ac]=(ad!==undefined)?ad:ab[ac];if(i.p.autoencode){O[ac]=a.jgrid.htmlEncode(O[ac])}}}return true}function u(am,ak,an,ai){var aj,ae,ar,ab=0,ap,ac,ad,al=[],ah=false,ao="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>",aq="",af;for(af=1;af<=ai;af++){aq+=ao}if(am!=="_empty"){ah=a(ak).jqGrid("getInd",am)}a(ak.p.colModel).each(function(aw){aj=this.name;if(this.editrules&&this.editrules.edithidden===true){ae=false}else{ae=this.hidden===true?true:false}ac=ae?"style='display:none'":"";if(aj!=="cb"&&aj!=="subgrid"&&this.editable===true&&aj!=="rn"){if(ah===false){ap=""}else{if(aj===ak.p.ExpandColumn&&ak.p.treeGrid===true){ap=a("td[role='gridcell']:eq("+aw+")",ak.rows[ah]).text()}else{try{ap=a.unformat.call(ak,a("td[role='gridcell']:eq("+aw+")",ak.rows[ah]),{rowId:am,colModel:this},aw)}catch(at){ap=(this.edittype&&this.edittype==="textarea")?a("td[role='gridcell']:eq("+aw+")",ak.rows[ah]).text():a("td[role='gridcell']:eq("+aw+")",ak.rows[ah]).html()}if(!ap||ap==="&nbsp;"||ap==="&#160;"||(ap.length===1&&ap.charCodeAt(0)===160)){ap=""}}}var ay=a.extend({},this.editoptions||{},{id:aj,name:aj,rowId:am,oper:"edit"}),av=a.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{}),az=parseInt(av.rowpos,10)||ab+1,au=parseInt((parseInt(av.colpos,10)||1)*2,10);if(am==="_empty"&&ay.defaultValue){ap=a.isFunction(ay.defaultValue)?ay.defaultValue.call(i):ay.defaultValue}if(!this.edittype){this.edittype="text"}if(i.p.autoencode){ap=a.jgrid.htmlDecode(ap)}ad=a.jgrid.createEl.call(i,this.edittype,ay,ap,false,a.extend({},a.jgrid.ajaxOptions,ak.p.ajaxSelectOptions||{}));if(this.edittype==="select"){ap=a(ad).val();if(a(ad).get(0).type==="select-multiple"&&ap){ap=ap.join(",")}}if(this.edittype==="checkbox"){if(a(ad).is(":checked")){ap=a(ad).val()}else{ap=a(ad).attr("offval")}}if(b[i.p.id].checkOnSubmit||b[i.p.id].checkOnUpdate){b[i.p.id]._savedData[aj]=ap}a(ad).addClass("FormElement");if(a.inArray(this.edittype,["text","textarea","password","select"])>-1){a(ad).addClass(h.inputClass)}if(X){a(A).find("#"+aj).replaceWith(ad)}else{ar=a(an).find("tr[rowpos="+az+"]");if(av.rowabove){var ax=a("<tr><td class='contentinfo' colspan='"+(ai*2)+"'>"+av.rowcontent+"</td></tr>");a(an).append(ax);ax[0].rp=az}if(ar.length===0){ar=a("<tr "+ac+" rowpos='"+az+"'></tr>").addClass("FormData").attr("id","tr_"+aj);a(ar).append(aq);a(an).append(ar);ar[0].rp=az}a("td:eq("+(au-2)+")",ar[0]).html("<label for='"+aj+"'>"+(av.label===undefined?ak.p.colNames[aw]:av.label)+"</label>");a("td:eq("+(au-1)+")",ar[0]).append(av.elmprefix).append(ad).append(av.elmsuffix)}if(this.edittype==="custom"&&a.isFunction(ay.custom_value)){ay.custom_value.call(i,a("#"+aj,B),"set",ap)}a.jgrid.bindEv.call(i,ad,ay);al[ab]=aw;ab++}});if(ab>0){var ag;if(X){ag="<div class='FormData' style='display:none'><input class='FormElement' id='id_g' type='text' name='"+ak.p.id+"_id' value='"+am+"'/>";a(A).append(ag)}else{ag=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(ai*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+ak.p.id+"_id' value='"+am+"'/></td></tr>");ag[0].rp=ab+999;a(an).append(ag)}if(b[i.p.id].checkOnSubmit||b[i.p.id].checkOnUpdate){b[i.p.id]._savedData[ak.p.id+"_id"]=am}}return al}function z(ai,ag,ae){var af,ac=0,aj,ad,ah,al,am;if(b[i.p.id].checkOnSubmit||b[i.p.id].checkOnUpdate){b[i.p.id]._savedData={};b[i.p.id]._savedData[ag.p.id+"_id"]=ai}var ab=ag.p.colModel;if(ai==="_empty"){a(ab).each(function(){af=this.name;ah=a.extend({},this.editoptions||{});ad=a("#"+a.jgrid.jqID(af),ae);if(ad&&ad.length&&ad[0]!==null){al="";if(this.edittype==="custom"&&a.isFunction(ah.custom_value)){ah.custom_value.call(i,a("#"+af,ae),"set",al)}else{if(ah.defaultValue){al=a.isFunction(ah.defaultValue)?ah.defaultValue.call(i):ah.defaultValue;if(ad[0].type==="checkbox"){am=al.toLowerCase();if(am.search(/(false|f|0|no|n|off|undefined)/i)<0&&am!==""){ad[0].checked=true;ad[0].defaultChecked=true;ad[0].value=al}else{ad[0].checked=false;ad[0].defaultChecked=false}}else{ad.val(al)}}else{if(ad[0].type==="checkbox"){ad[0].checked=false;ad[0].defaultChecked=false;al=a(ad).attr("offval")}else{if(ad[0].type&&ad[0].type.substr(0,6)==="select"){ad[0].selectedIndex=0}else{ad.val(al)}}}}if(b[i.p.id].checkOnSubmit===true||b[i.p.id].checkOnUpdate){b[i.p.id]._savedData[af]=al}}});a("#id_g",ae).val(ai);return}var ak=a(ag).jqGrid("getInd",ai,true);if(!ak){return}a('td[role="gridcell"]',ak).each(function(aq){af=ab[aq].name;if(af!=="cb"&&af!=="subgrid"&&af!=="rn"&&ab[aq].editable===true){if(af===ag.p.ExpandColumn&&ag.p.treeGrid===true){aj=a(this).text()}else{try{aj=a.unformat.call(ag,a(this),{rowId:ai,colModel:ab[aq]},aq)}catch(an){aj=ab[aq].edittype==="textarea"?a(this).text():a(this).html()}}if(i.p.autoencode){aj=a.jgrid.htmlDecode(aj)}if(b[i.p.id].checkOnSubmit===true||b[i.p.id].checkOnUpdate){b[i.p.id]._savedData[af]=aj}af=a.jgrid.jqID(af);switch(ab[aq].edittype){case"password":case"text":case"button":case"image":case"textarea":if(aj==="&nbsp;"||aj==="&#160;"||(aj.length===1&&aj.charCodeAt(0)===160)){aj=""}a("#"+af,ae).val(aj);break;case"select":var ar=aj.split(",");ar=a.map(ar,function(at){return a.trim(at)});a("#"+af+" option",ae).each(function(){if(!ab[aq].editoptions.multiple&&(a.trim(aj)===a.trim(a(this).text())||ar[0]===a.trim(a(this).text())||ar[0]===a.trim(a(this).val()))){this.selected=true}else{if(ab[aq].editoptions.multiple){if(a.inArray(a.trim(a(this).text()),ar)>-1||a.inArray(a.trim(a(this).val()),ar)>-1){this.selected=true}else{this.selected=false}}else{this.selected=false}}});if(b[i.p.id].checkOnSubmit===true||b[i.p.id].checkOnUpdate){aj=a("#"+af,ae).val();if(ab[aq].editoptions.multiple){aj=aj.join(",")}b[i.p.id]._savedData[af]=aj}break;case"checkbox":aj=String(aj);if(ab[aq].editoptions&&ab[aq].editoptions.value){var ao=ab[aq].editoptions.value.split(":");if(ao[0]===aj){a("#"+af,ae)[i.p.useProp?"prop":"attr"]({checked:true,defaultChecked:true})}else{a("#"+af,ae)[i.p.useProp?"prop":"attr"]({checked:false,defaultChecked:false})}}else{aj=aj.toLowerCase();if(aj.search(/(false|f|0|no|n|off|undefined)/i)<0&&aj!==""){a("#"+af,ae)[i.p.useProp?"prop":"attr"]("checked",true);a("#"+af,ae)[i.p.useProp?"prop":"attr"]("defaultChecked",true)}else{a("#"+af,ae)[i.p.useProp?"prop":"attr"]("checked",false);a("#"+af,ae)[i.p.useProp?"prop":"attr"]("defaultChecked",false)}}if(b[i.p.id].checkOnSubmit===true||b[i.p.id].checkOnUpdate){if(a("#"+af,ae).is(":checked")){aj=a("#"+af,ae).val()}else{aj=a("#"+af,ae).attr("offval")}b[i.p.id]._savedData[af]=aj}break;case"custom":try{if(ab[aq].editoptions&&a.isFunction(ab[aq].editoptions.custom_value)){ab[aq].editoptions.custom_value.call(i,a("#"+af,ae),"set",aj)}else{throw"e1"}}catch(ap){if(ap==="e1"){a.jgrid.info_dialog(y.errcap,"function 'custom_value' "+b[a(this)[0]].p.msg.nodefined,a.rp_ge[a(this)[0]].p.bClose,{styleUI:b[a(this)[0]].p.styleUI})}else{a.jgrid.info_dialog(y.errcap,ap.message,a.rp_ge[a(this)[0]].p.bClose,{styleUI:b[a(this)[0]].p.styleUI})}}break}ac++}});if(ac>0){a("#id_g",D).val(ai);if(b[i.p.id].checkOnSubmit===true||b[i.p.id].checkOnUpdate){b[i.p.id]._savedData[ag.p.id+"_id"]=ai}}}function T(){a.each(i.p.colModel,function(ab,ac){if(ac.editoptions&&ac.editoptions.NullIfEmpty===true){if(O.hasOwnProperty(ac.name)&&O[ac.name]===""){O[ac.name]="null"}}})}function P(){var ac,al=[true,"",""],ai={},ak=i.p.prmNames,af,aj,ah,an,ae,ap;var am=a(i).triggerHandler("jqGridAddEditBeforeCheckValues",[a(B),C]);if(am&&typeof am==="object"){O=am}if(a.isFunction(b[i.p.id].beforeCheckValues)){am=b[i.p.id].beforeCheckValues.call(i,O,a(B),C);if(am&&typeof am==="object"){O=am}}for(ah in O){if(O.hasOwnProperty(ah)){al=a.jgrid.checkValues.call(i,O[ah],ah);if(al[0]===false){break}}}T();if(al[0]){ai=a(i).triggerHandler("jqGridAddEditClickSubmit",[b[i.p.id],O,C]);if(ai===undefined&&a.isFunction(b[i.p.id].onclickSubmit)){ai=b[i.p.id].onclickSubmit.call(i,b[i.p.id],O,C)||{}}al=a(i).triggerHandler("jqGridAddEditBeforeSubmit",[O,a(B),C]);if(al===undefined){al=[true,"",""]}if(al[0]&&a.isFunction(b[i.p.id].beforeSubmit)){al=b[i.p.id].beforeSubmit.call(i,O,a(B),C)}}if(al[0]&&!b[i.p.id].processing){b[i.p.id].processing=true;a("#sData",D+"_2").addClass(c.active);ap=b[i.p.id].url||a(i).jqGrid("getGridParam","editurl");aj=ak.oper;af=ap==="clientArray"?i.p.keyName:ak.id;O[aj]=(a.trim(O[i.p.id+"_id"])==="_empty")?ak.addoper:ak.editoper;if(O[aj]!==ak.addoper){O[af]=O[i.p.id+"_id"]}else{if(O[af]===undefined){O[af]=O[i.p.id+"_id"]}}delete O[i.p.id+"_id"];O=a.extend(O,b[i.p.id].editData,ai);if(i.p.treeGrid===true){if(O[aj]===ak.addoper){an=a(i).jqGrid("getGridParam","selrow");var ao=i.p.treeGridModel==="adjacency"?i.p.treeReader.parent_id_field:"parent_id";O[ao]=an}for(ae in i.p.treeReader){if(i.p.treeReader.hasOwnProperty(ae)){var ag=i.p.treeReader[ae];if(O.hasOwnProperty(ag)){if(O[aj]===ak.addoper&&ae==="parent_id_field"){continue}delete O[ag]}}}}O[af]=a.jgrid.stripPref(i.p.idPrefix,O[af]);var ab=a.extend({url:ap,type:b[i.p.id].mtype,data:a.isFunction(b[i.p.id].serializeEditData)?b[i.p.id].serializeEditData.call(i,O):O,complete:function(aq,au){var at;a("#sData",D+"_2").removeClass(c.active);O[af]=i.p.idPrefix+O[af];if(aq.status>=300&&aq.status!==304){al[0]=false;al[1]=a(i).triggerHandler("jqGridAddEditErrorTextFormat",[aq,C]);if(a.isFunction(b[i.p.id].errorTextFormat)){al[1]=b[i.p.id].errorTextFormat.call(i,aq,C)}else{al[1]=au+" Status: '"+aq.statusText+"'. Error code: "+aq.status}}else{al=a(i).triggerHandler("jqGridAddEditAfterSubmit",[aq,O,C]);if(al===undefined){al=[true,"",""]}if(al[0]&&a.isFunction(b[i.p.id].afterSubmit)){al=b[i.p.id].afterSubmit.call(i,aq,O,C)}}if(al[0]===false){a(".FormError",B).html(al[1]);a(".FormError",B).show()}else{if(i.p.autoencode){a.each(O,function(av,aw){O[av]=a.jgrid.htmlDecode(aw)})}if(O[aj]===ak.addoper){if(!al[2]){al[2]=a.jgrid.randId()}if(O[af]==null||O[af]==="_empty"){O[af]=al[2]}else{al[2]=O[af]}if(b[i.p.id].reloadAfterSubmit){a(i).trigger("reloadGrid")}else{if(i.p.treeGrid===true){a(i).jqGrid("addChildNode",al[2],an,O)}else{a(i).jqGrid("addRowData",al[2],O,e.addedrow)}}if(b[i.p.id].closeAfterAdd){if(i.p.treeGrid!==true){a(i).jqGrid("setSelection",al[2])}a.jgrid.hideModal("#"+a.jgrid.jqID(J.themodal),{gb:"#gbox_"+a.jgrid.jqID(I),jqm:e.jqModal,onClose:b[i.p.id].onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form})}else{if(b[i.p.id].clearAfterAdd){z("_empty",i,B)}}}else{if(b[i.p.id].reloadAfterSubmit){a(i).trigger("reloadGrid");if(!b[i.p.id].closeAfterEdit){setTimeout(function(){a(i).jqGrid("setSelection",O[af])},1000)}}else{if(i.p.treeGrid===true){a(i).jqGrid("setTreeRow",O[af],O)}else{a(i).jqGrid("setRowData",O[af],O)}}if(b[i.p.id].closeAfterEdit){a.jgrid.hideModal("#"+a.jgrid.jqID(J.themodal),{gb:"#gbox_"+a.jgrid.jqID(I),jqm:e.jqModal,onClose:b[i.p.id].onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form})}}if(a.isFunction(b[i.p.id].afterComplete)){ac=aq;setTimeout(function(){a(i).triggerHandler("jqGridAddEditAfterComplete",[ac,O,a(B),C]);b[i.p.id].afterComplete.call(i,ac,O,a(B),C);ac=null},500)}if(b[i.p.id].checkOnSubmit||b[i.p.id].checkOnUpdate){a(B).data("disabled",false);if(b[i.p.id]._savedData[i.p.id+"_id"]!=="_empty"){for(at in b[i.p.id]._savedData){if(b[i.p.id]._savedData.hasOwnProperty(at)&&O[at]){b[i.p.id]._savedData[at]=O[at]}}}}}b[i.p.id].processing=false;try{a(":input:visible",B)[0].focus()}catch(ar){}}},a.jgrid.ajaxOptions,b[i.p.id].ajaxEditOptions);if(!ab.url&&!b[i.p.id].useDataProxy){if(a.isFunction(i.p.dataProxy)){b[i.p.id].useDataProxy=true}else{al[0]=false;al[1]+=" "+y.nourl}}if(al[0]){if(b[i.p.id].useDataProxy){var ad=i.p.dataProxy.call(i,ab,"set_"+i.p.id);if(ad===undefined){ad=[true,""]}if(ad[0]===false){al[0]=false;al[1]=ad[1]||"Error deleting the selected row!"}else{if(ab.data.oper===ak.addoper&&b[i.p.id].closeAfterAdd){a.jgrid.hideModal("#"+a.jgrid.jqID(J.themodal),{gb:"#gbox_"+a.jgrid.jqID(I),jqm:e.jqModal,onClose:b[i.p.id].onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form})}if(ab.data.oper===ak.editoper&&b[i.p.id].closeAfterEdit){a.jgrid.hideModal("#"+a.jgrid.jqID(J.themodal),{gb:"#gbox_"+a.jgrid.jqID(I),jqm:e.jqModal,onClose:b[i.p.id].onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form})}}}else{if(ab.url==="clientArray"){b[i.p.id].reloadAfterSubmit=false;O=ab.data;ab.complete({status:200,statusText:""},"")}else{a.ajax(ab)}}}}if(al[0]===false){a(".FormError",B).html(al[1]);a(".FormError",B).show()}}function t(ac,ad){var ae=false,ab;for(ab in ac){if(ac.hasOwnProperty(ab)&&ac[ab]!=ad[ab]){ae=true;break}}return ae}function q(){var ab=true;a(".FormError",B).hide();if(b[i.p.id].checkOnUpdate){O={};H();w=t(O,b[i.p.id]._savedData);if(w){a(B).data("disabled",true);a(".confirm","#"+J.themodal).show();ab=false}}return ab}function Q(){var ab;if(g!=="_empty"&&i.p.savedRow!==undefined&&i.p.savedRow.length>0&&a.isFunction(a.fn.jqGrid.restoreRow)){for(ab=0;ab<i.p.savedRow.length;ab++){if(i.p.savedRow[ab].id===g){a(i).jqGrid("restoreRow",g);break}}}}function Z(ab,ac){var ad=ac[1].length-1;if(ab===0){a("#pData",E).addClass(c.disabled)}else{if(ac[1][ab-1]!==undefined&&a("#"+a.jgrid.jqID(ac[1][ab-1])).hasClass(c.disabled)){a("#pData",E).addClass(c.disabled)}else{a("#pData",E).removeClass(c.disabled)}}if(ab===ad){a("#nData",E).addClass(c.disabled)}else{if(ac[1][ab+1]!==undefined&&a("#"+a.jgrid.jqID(ac[1][ab+1])).hasClass(c.disabled)){a("#nData",E).addClass(c.disabled)}else{a("#nData",E).removeClass(c.disabled)}}}function G(){var ac=a(i).jqGrid("getDataIDs"),ad=a("#id_g",D).val(),ab=a.inArray(ad,ac);return[ab,ac]}function M(ab){var ac="";if(typeof ab==="string"){ac=ab.replace(/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,function(ae,ad){return'<span id="'+ad+'" ></span>'})}return ac}function V(){if(b[i.p.id].checkOnSubmit||b[i.p.id].checkOnUpdate){var ab=[],ac={};ab=a.map(b[i.p.id]._savedData,function(ag,af){return af});a(".FormElement",A).each(function(){if(ab.indexOf(this.name)===-1){var ag=a(this).val(),af=a(this).get(0).type;if(af==="checkbox"){if(!a(this).is(":checked")){ag=a(this).attr("offval")}}else{if(af==="select-multiple"){ag=ag.join(",")}else{if(af==="radio"){if(ac.hasOwnProperty(this.name)){return true}else{ac[this.name]=(a(this).attr("offval")===undefined)?"off":a(this).attr("offval")}}}}b[i.p.id]._savedData[this.name]=ag}});for(var ad in ac){if(ac.hasOwnProperty(ad)){var ae=a('input[name="'+ad+'"]:checked',A).val();b[i.p.id]._savedData[ad]=(ae!==undefined)?ae:ac[ad]}}}}var v=isNaN(b[a(this)[0].p.id].dataheight)?b[a(this)[0].p.id].dataheight:b[a(this)[0].p.id].dataheight+"px",x=isNaN(b[a(this)[0].p.id].datawidth)?b[a(this)[0].p.id].datawidth:b[a(this)[0].p.id].datawidth+"px",A=a("<form name='FormPost' id='"+B+"' class='FormGrid' onSubmit='return false;' style='width:"+x+";height:"+v+";'></form>").data("disabled",false),W;if(X){W=M(b[a(this)[0].p.id].template);E=D}else{W=a("<table id='"+F+"' class='EditTable ui-common-table'><tbody></tbody></table>");E=D+"_2"}B="#"+a.jgrid.jqID(B);a(A).append("<div class='FormError "+c.error+"' style='display:none;'></div>");a(A).append("<div class='tinfo topinfo'>"+b[i.p.id].topinfo+"</div>");a(i.p.colModel).each(function(){var ab=this.formoptions;K=Math.max(K,ab?ab.colpos||0:0);L=Math.max(L,ab?ab.rowpos||0:0)});a(A).append(W);U=a(i).triggerHandler("jqGridAddEditBeforeInitData",[A,C]);if(U===undefined){U=true}if(U&&a.isFunction(b[i.p.id].beforeInitData)){U=b[i.p.id].beforeInitData.call(i,A,C)}if(U===false){return}Q();u(g,i,W,K);var R=i.p.direction==="rtl"?true:false,m=R?"nData":"pData",k=R?"pData":"nData";var n="<a id='"+m+"' class='fm-button "+c.button+"'><span class='"+c.icon_base+" "+h.icon_prev+"'></span></a>",l="<a id='"+k+"' class='fm-button "+c.button+"'><span class='"+c.icon_base+" "+h.icon_next+"'></span></a>",o="<a id='sData' class='fm-button "+c.button+"'>"+e.bSubmit+"</a>",j="<a id='cData' class='fm-button "+c.button+"'>"+e.bCancel+"</a>";var p="<table style='height:auto' class='EditTable ui-common-table' id='"+F+"_2'><tbody><tr><td colspan='2'><hr class='"+c.content+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(R?l+n:n+l)+"</td><td class='EditButton'>"+o+j+"</td></tr>";p+="</tbody></table>";if(L>0){var S=[];a.each(a(W)[0].rows,function(ab,ac){S[ab]=ac});S.sort(function(ab,ac){if(ab.rp>ac.rp){return 1}if(ab.rp<ac.rp){return -1}return 0});a.each(S,function(ab,ac){a("tbody",W).append(ac)})}e.gbox="#gbox_"+a.jgrid.jqID(I);var r=false;if(e.closeOnEscape===true){e.closeOnEscape=false;r=true}var Y;if(X){a(A).find("#pData").replaceWith(n);a(A).find("#nData").replaceWith(l);a(A).find("#sData").replaceWith(o);a(A).find("#cData").replaceWith(j);Y=a("<div id="+F+"></div>").append(A)}else{Y=a("<div></div>").append(A).append(p)}a(A).append("<div class='binfo topinfo bottominfo'>"+b[i.p.id].bottominfo+"</div>");a.jgrid.createModal(J,Y,b[a(this)[0].p.id],"#gview_"+a.jgrid.jqID(i.p.id),a("#gbox_"+a.jgrid.jqID(i.p.id))[0]);if(R){a("#pData, #nData",D+"_2").css("float","right");a(".EditButton",D+"_2").css("text-align","left")}if(b[i.p.id].topinfo){a(".tinfo",B).show()}if(b[i.p.id].bottominfo){a(".binfo",B).show()}Y=null;p=null;a("#"+a.jgrid.jqID(J.themodal)).keydown(function(ab){var ac=ab.target;if(a(B).data("disabled")===true){return false}if(b[i.p.id].savekey[0]===true&&ab.which===b[i.p.id].savekey[1]){if(ac.tagName!=="TEXTAREA"){a("#sData",D+"_2").trigger("click");return false}}if(ab.which===27){if(!q()){return false}if(r){a.jgrid.hideModal("#"+a.jgrid.jqID(J.themodal),{gb:e.gbox,jqm:e.jqModal,onClose:b[i.p.id].onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form})}return false}if(b[i.p.id].navkeys[0]===true){if(a("#id_g",D).val()==="_empty"){return true}if(ab.which===b[i.p.id].navkeys[1]){a("#pData",E).trigger("click");return false}if(ab.which===b[i.p.id].navkeys[2]){a("#nData",E).trigger("click");return false}}});if(e.checkOnUpdate){a("a.ui-jqdialog-titlebar-close span","#"+a.jgrid.jqID(J.themodal)).removeClass("jqmClose");a("a.ui-jqdialog-titlebar-close","#"+a.jgrid.jqID(J.themodal)).unbind("click").click(function(){if(!q()){return false}a.jgrid.hideModal("#"+a.jgrid.jqID(J.themodal),{gb:"#gbox_"+a.jgrid.jqID(I),jqm:e.jqModal,onClose:b[i.p.id].onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form});return false})}e.saveicon=a.extend([true,"left",h.icon_save],e.saveicon);e.closeicon=a.extend([true,"left",h.icon_close],e.closeicon);if(e.saveicon[0]===true){a("#sData",E).addClass(e.saveicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+c.icon_base+" "+e.saveicon[2]+"'></span>")}if(e.closeicon[0]===true){a("#cData",E).addClass(e.closeicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+c.icon_base+" "+e.closeicon[2]+"'></span>")}if(b[i.p.id].checkOnSubmit||b[i.p.id].checkOnUpdate){o="<a id='sNew' class='fm-button "+c.button+"' style='z-index:1002'>"+e.bYes+"</a>";l="<a id='nNew' class='fm-button "+c.button+"' style='z-index:1002;margin-left:5px'>"+e.bNo+"</a>";j="<a id='cNew' class='fm-button "+c.button+"' style='z-index:1002;margin-left:5px;'>"+e.bExit+"</a>";var aa=e.zIndex||999;aa++;a("<div class='"+e.overlayClass+" jqgrid-overlay confirm' style='z-index:"+aa+";display:none;'>&#160;</div><div class='confirm ui-jqconfirm "+c.content+"' style='z-index:"+(aa+1)+"'>"+e.saveData+"<br/><br/>"+o+l+j+"</div>").insertAfter(B);a("#sNew","#"+a.jgrid.jqID(J.themodal)).click(function(){P();a(B).data("disabled",false);a(".confirm","#"+a.jgrid.jqID(J.themodal)).hide();return false});a("#nNew","#"+a.jgrid.jqID(J.themodal)).click(function(){a(".confirm","#"+a.jgrid.jqID(J.themodal)).hide();a(B).data("disabled",false);setTimeout(function(){a(":input:visible",B)[0].focus()},0);return false});a("#cNew","#"+a.jgrid.jqID(J.themodal)).click(function(){a(".confirm","#"+a.jgrid.jqID(J.themodal)).hide();a(B).data("disabled",false);a.jgrid.hideModal("#"+a.jgrid.jqID(J.themodal),{gb:"#gbox_"+a.jgrid.jqID(I),jqm:e.jqModal,onClose:b[i.p.id].onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form});return false})}a(i).triggerHandler("jqGridAddEditInitializeForm",[a(B),C]);if(a.isFunction(b[i.p.id].onInitializeForm)){b[i.p.id].onInitializeForm.call(i,a(B),C)}if(g==="_empty"||!b[i.p.id].viewPagerButtons){a("#pData,#nData",E).hide()}else{a("#pData,#nData",E).show()}a(i).triggerHandler("jqGridAddEditBeforeShowForm",[a(B),C]);if(a.isFunction(b[i.p.id].beforeShowForm)){b[i.p.id].beforeShowForm.call(i,a(B),C)}V();a("#"+a.jgrid.jqID(J.themodal)).data("onClose",b[i.p.id].onClose);a.jgrid.viewModal("#"+a.jgrid.jqID(J.themodal),{gbox:"#gbox_"+a.jgrid.jqID(I),jqm:e.jqModal,overlay:e.overlay,modal:e.modal,overlayClass:e.overlayClass,focusField:e.focusField,onHide:function(ad){var ab=a("#editmod"+I)[0].style.height,ac=a("#editmod"+I)[0].style.width;if(ab.indexOf("px")>-1){ab=parseFloat(ab)}if(ac.indexOf("px")>-1){ac=parseFloat(ac)}a(i).data("formProp",{top:parseFloat(a(ad.w).css("top")),left:parseFloat(a(ad.w).css("left")),width:ac,height:ab,dataheight:a(B).height(),datawidth:a(B).width()});ad.w.remove();if(ad.o){ad.o.remove()}}});if(!s){a("."+a.jgrid.jqID(e.overlayClass)).click(function(){if(!q()){return false}a.jgrid.hideModal("#"+a.jgrid.jqID(J.themodal),{gb:"#gbox_"+a.jgrid.jqID(I),jqm:e.jqModal,onClose:b[i.p.id].onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form});return false})}a(".fm-button","#"+a.jgrid.jqID(J.themodal)).hover(function(){a(this).addClass(c.hover)},function(){a(this).removeClass(c.hover)});a("#sData",E).click(function(){O={};a(".FormError",B).hide();H();if(O[i.p.id+"_id"]==="_empty"){P()}else{if(e.checkOnSubmit===true){w=t(O,b[i.p.id]._savedData);if(w){a(B).data("disabled",true);a(".confirm","#"+a.jgrid.jqID(J.themodal)).show()}else{P()}}else{P()}}return false});a("#cData",E).click(function(){if(!q()){return false}a.jgrid.hideModal("#"+a.jgrid.jqID(J.themodal),{gb:"#gbox_"+a.jgrid.jqID(I),jqm:e.jqModal,onClose:b[i.p.id].onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form});return false});a("#nData",E).click(function(){if(!q()){return false}a(".FormError",B).hide();var ab=G();ab[0]=parseInt(ab[0],10);if(ab[0]!==-1&&ab[1][ab[0]+1]){a(i).triggerHandler("jqGridAddEditClickPgButtons",["next",a(B),ab[1][ab[0]]]);var ac;if(a.isFunction(e.onclickPgButtons)){ac=e.onclickPgButtons.call(i,"next",a(B),ab[1][ab[0]]);if(ac!==undefined&&ac===false){return false}}if(a("#"+a.jgrid.jqID(ab[1][ab[0]+1])).hasClass(c.disabled)){return false}z(ab[1][ab[0]+1],i,B);a(i).jqGrid("setSelection",ab[1][ab[0]+1]);a(i).triggerHandler("jqGridAddEditAfterClickPgButtons",["next",a(B),ab[1][ab[0]]]);if(a.isFunction(e.afterclickPgButtons)){e.afterclickPgButtons.call(i,"next",a(B),ab[1][ab[0]+1])}V();Z(ab[0]+1,ab)}return false});a("#pData",E).click(function(){if(!q()){return false}a(".FormError",B).hide();var ab=G();if(ab[0]!==-1&&ab[1][ab[0]-1]){a(i).triggerHandler("jqGridAddEditClickPgButtons",["prev",a(B),ab[1][ab[0]]]);var ac;if(a.isFunction(e.onclickPgButtons)){ac=e.onclickPgButtons.call(i,"prev",a(B),ab[1][ab[0]]);if(ac!==undefined&&ac===false){return false}}if(a("#"+a.jgrid.jqID(ab[1][ab[0]-1])).hasClass(c.disabled)){return false}z(ab[1][ab[0]-1],i,B);a(i).jqGrid("setSelection",ab[1][ab[0]-1]);a(i).triggerHandler("jqGridAddEditAfterClickPgButtons",["prev",a(B),ab[1][ab[0]]]);if(a.isFunction(e.afterclickPgButtons)){e.afterclickPgButtons.call(i,"prev",a(B),ab[1][ab[0]-1])}V();Z(ab[0]-1,ab)}return false});a(i).triggerHandler("jqGridAddEditAfterShowForm",[a(B),C]);if(a.isFunction(b[i.p.id].afterShowForm)){b[i.p.id].afterShowForm.call(i,a(B),C)}var N=G();Z(N[0],N)})},viewGridRow:function(g,e){var f=a.jgrid.getRegional(this[0],"view"),d=this[0].p.styleUI,h=a.jgrid.styleUI[d].formedit,c=a.jgrid.styleUI[d].common;e=a.extend(true,{top:0,left:0,width:500,datawidth:"auto",height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,jqModal:true,closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:true,recreateForm:false,removemodal:true,form:"view"},f,e||{});b[a(this)[0].p.id]=e;return this.each(function(){var i=this;if(!i.grid||!g){return}var A=i.p.id,v="ViewGrid_"+a.jgrid.jqID(A),x="ViewTbl_"+a.jgrid.jqID(A),w="ViewGrid_"+A,y="ViewTbl_"+A,B={themodal:"viewmod"+A,modalhead:"viewhd"+A,modalcontent:"viewcnt"+A,scrollelm:v},E=a.isFunction(b[i.p.id].beforeInitData)?b[i.p.id].beforeInitData:false,I=true,C=1,D=0;b[i.p.id].styleUI=i.p.styleUI||"jQueryUI";if(!e.recreateForm){if(a(i).data("viewProp")){a.extend(b[a(this)[0].p.id],a(i).data("viewProp"))}}function t(){if(b[i.p.id].closeOnEscape===true||b[i.p.id].navkeys[0]===true){setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+a.jgrid.jqID(B.modalhead)).attr("tabindex","-1").focus()},0)}}function p(Z,X,ab,U){var W,O,ag,L=0,ae,M,Y=[],R=false,P,ac="<td class='CaptionTD form-view-label "+c.content+"' width='"+e.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset "+c.content+"'>&#160;</td>",af="",ad="<td class='CaptionTD form-view-label "+c.content+"'>&#160;</td><td class='DataTD form-view-data "+c.content+"'>&#160;</td>",N=["integer","number","currency"],S=0,T=0,V,aa,ah;for(P=1;P<=U;P++){af+=P===1?ac:ad}a(X.p.colModel).each(function(){if(this.editrules&&this.editrules.edithidden===true){O=false}else{O=this.hidden===true?true:false}if(!O&&this.align==="right"){if(this.formatter&&a.inArray(this.formatter,N)!==-1){S=Math.max(S,parseInt(this.width,10))}else{T=Math.max(T,parseInt(this.width,10))}}});V=S!==0?S:T!==0?T:0;R=a(X).jqGrid("getInd",Z);a(X.p.colModel).each(function(ak){W=this.name;aa=false;if(this.editrules&&this.editrules.edithidden===true){O=false}else{O=this.hidden===true?true:false}M=O?"style='display:none'":"";ah=(typeof this.viewable!=="boolean")?true:this.viewable;if(W!=="cb"&&W!=="subgrid"&&W!=="rn"&&ah){if(R===false){ae=""}else{if(W===X.p.ExpandColumn&&X.p.treeGrid===true){ae=a("td:eq("+ak+")",X.rows[R]).text()}else{ae=a("td:eq("+ak+")",X.rows[R]).html()}}aa=this.align==="right"&&V!==0?true:false;var aj=a.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),am=parseInt(aj.rowpos,10)||L+1,ai=parseInt((parseInt(aj.colpos,10)||1)*2,10);if(aj.rowabove){var al=a("<tr><td class='contentinfo' colspan='"+(U*2)+"'>"+aj.rowcontent+"</td></tr>");a(ab).append(al);al[0].rp=am}ag=a(ab).find("tr[rowpos="+am+"]");if(ag.length===0){ag=a("<tr "+M+" rowpos='"+am+"'></tr>").addClass("FormData").attr("id","trv_"+W);a(ag).append(af);a(ab).append(ag);ag[0].rp=am}a("td:eq("+(ai-2)+")",ag[0]).html("<b>"+(aj.label===undefined?X.p.colNames[ak]:aj.label)+"</b>");a("td:eq("+(ai-1)+")",ag[0]).append("<span>"+ae+"</span>").attr("id","v_"+W);if(aa){a("td:eq("+(ai-1)+") span",ag[0]).css({"text-align":"right",width:V+"px"})}Y[L]=ak;L++}});if(L>0){var Q=a("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(U*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+Z+"'/></td></tr>");Q[0].rp=L+99;a(ab).append(Q)}return Y}function s(P,O){var N,M,L=0,Q,R;R=a(O).jqGrid("getInd",P,true);if(!R){return}a("td",R).each(function(S){N=O.p.colModel[S].name;if(O.p.colModel[S].editrules&&O.p.colModel[S].editrules.edithidden===true){M=false}else{M=O.p.colModel[S].hidden===true?true:false}if(N!=="cb"&&N!=="subgrid"&&N!=="rn"){if(N===O.p.ExpandColumn&&O.p.treeGrid===true){Q=a(this).text()}else{Q=a(this).html()}N=a.jgrid.jqID("v_"+N);a("#"+N+" span","#"+x).html(Q);if(M){a("#"+N,"#"+x).parents("tr:first").hide()}L++}});if(L>0){a("#id_g","#"+x).val(P)}}function K(L,M){var N=M[1].length-1;if(L===0){a("#pData","#"+x+"_2").addClass(c.disabled)}else{if(M[1][L-1]!==undefined&&a("#"+a.jgrid.jqID(M[1][L-1])).hasClass(c.disabled)){a("#pData",x+"_2").addClass(c.disabled)}else{a("#pData","#"+x+"_2").removeClass(c.disabled)}}if(L===N){a("#nData","#"+x+"_2").addClass(c.disabled)}else{if(M[1][L+1]!==undefined&&a("#"+a.jgrid.jqID(M[1][L+1])).hasClass(c.disabled)){a("#nData",x+"_2").addClass(c.disabled)}else{a("#nData","#"+x+"_2").removeClass(c.disabled)}}}function z(){var M=a(i).jqGrid("getDataIDs"),N=a("#id_g","#"+x).val(),L=a.inArray(N,M);return[L,M]}var q=isNaN(b[a(this)[0].p.id].dataheight)?b[a(this)[0].p.id].dataheight:b[a(this)[0].p.id].dataheight+"px",r=isNaN(b[a(this)[0].p.id].datawidth)?b[a(this)[0].p.id].datawidth:b[a(this)[0].p.id].datawidth+"px",u=a("<form name='FormPost' id='"+w+"' class='FormGrid' style='width:"+r+";height:"+q+";'></form>"),J=a("<table id='"+y+"' class='EditTable ViewTable'><tbody></tbody></table>");a(i.p.colModel).each(function(){var L=this.formoptions;C=Math.max(C,L?L.colpos||0:0);D=Math.max(D,L?L.rowpos||0:0)});a(u).append(J);if(E){I=E.call(i,u);if(I===undefined){I=true}}if(I===false){return}p(g,i,J,C);var G=i.p.direction==="rtl"?true:false,m=G?"nData":"pData",k=G?"pData":"nData",n="<a id='"+m+"' class='fm-button "+c.button+"'><span class='"+c.icon_base+" "+h.icon_prev+"'></span></a>",l="<a id='"+k+"' class='fm-button "+c.button+"'><span class='"+c.icon_base+" "+h.icon_next+"'></span></a>",j="<a id='cData' class='fm-button "+c.button+"'>"+e.bClose+"</a>";if(D>0){var H=[];a.each(a(J)[0].rows,function(L,M){H[L]=M});H.sort(function(L,M){if(L.rp>M.rp){return 1}if(L.rp<M.rp){return -1}return 0});a.each(H,function(L,M){a("tbody",J).append(M)})}e.gbox="#gbox_"+a.jgrid.jqID(A);var o=a("<div></div>").append(u).append("<table border='0' class='EditTable' id='"+x+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+e.labelswidth+"'>"+(G?l+n:n+l)+"</td><td class='EditButton'>"+j+"</td></tr></tbody></table>");a.jgrid.createModal(B,o,b[a(this)[0].p.id],"#gview_"+a.jgrid.jqID(i.p.id),a("#gview_"+a.jgrid.jqID(i.p.id))[0]);if(G){a("#pData, #nData","#"+x+"_2").css("float","right");a(".EditButton","#"+x+"_2").css("text-align","left")}if(!e.viewPagerButtons){a("#pData, #nData","#"+x+"_2").hide()}o=null;a("#"+B.themodal).keydown(function(L){if(L.which===27){if(b[i.p.id].closeOnEscape){a.jgrid.hideModal("#"+a.jgrid.jqID(B.themodal),{gb:e.gbox,jqm:e.jqModal,onClose:e.onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form})}return false}if(e.navkeys[0]===true){if(L.which===e.navkeys[1]){a("#pData","#"+x+"_2").trigger("click");return false}if(L.which===e.navkeys[2]){a("#nData","#"+x+"_2").trigger("click");return false}}});e.closeicon=a.extend([true,"left",h.icon_close],e.closeicon);if(e.closeicon[0]===true){a("#cData","#"+x+"_2").addClass(e.closeicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+c.icon_base+" "+e.closeicon[2]+"'></span>")}if(a.isFunction(e.beforeShowForm)){e.beforeShowForm.call(i,a("#"+v))}a.jgrid.viewModal("#"+a.jgrid.jqID(B.themodal),{gbox:"#gbox_"+a.jgrid.jqID(A),jqm:e.jqModal,overlay:e.overlay,modal:e.modal,onHide:function(L){a(i).data("viewProp",{top:parseFloat(a(L.w).css("top")),left:parseFloat(a(L.w).css("left")),width:a(L.w).width(),height:a(L.w).height(),dataheight:a("#"+v).height(),datawidth:a("#"+v).width()});L.w.remove();if(L.o){L.o.remove()}}});a(".fm-button:not(."+c.disabled+")","#"+x+"_2").hover(function(){a(this).addClass(c.hover)},function(){a(this).removeClass(c.hover)});t();a("#cData","#"+x+"_2").click(function(){a.jgrid.hideModal("#"+a.jgrid.jqID(B.themodal),{gb:"#gbox_"+a.jgrid.jqID(A),jqm:e.jqModal,onClose:e.onClose,removemodal:b[i.p.id].removemodal,formprop:!b[i.p.id].recreateForm,form:b[i.p.id].form});return false});a("#nData","#"+x+"_2").click(function(){a("#FormError","#"+x).hide();var L=z();L[0]=parseInt(L[0],10);if(L[0]!==-1&&L[1][L[0]+1]){if(a.isFunction(e.onclickPgButtons)){e.onclickPgButtons.call(i,"next",a("#"+v),L[1][L[0]])}s(L[1][L[0]+1],i);a(i).jqGrid("setSelection",L[1][L[0]+1]);if(a.isFunction(e.afterclickPgButtons)){e.afterclickPgButtons.call(i,"next",a("#"+v),L[1][L[0]+1])}K(L[0]+1,L)}t();return false});a("#pData","#"+x+"_2").click(function(){a("#FormError","#"+x).hide();var L=z();if(L[0]!==-1&&L[1][L[0]-1]){if(a.isFunction(e.onclickPgButtons)){e.onclickPgButtons.call(i,"prev",a("#"+v),L[1][L[0]])}s(L[1][L[0]-1],i);a(i).jqGrid("setSelection",L[1][L[0]-1]);if(a.isFunction(e.afterclickPgButtons)){e.afterclickPgButtons.call(i,"prev",a("#"+v),L[1][L[0]-1])}K(L[0]-1,L)}t();return false});var F=z();K(F[0],F)})},delGridRow:function(g,e){var f=a.jgrid.getRegional(this[0],"del"),d=this[0].p.styleUI,h=a.jgrid.styleUI[d].formedit,c=a.jgrid.styleUI[d].common;e=a.extend(true,{top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,overlay:30,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:false,serializeDelData:null,useDataProxy:false},f,e||{});b[a(this)[0].p.id]=e;return this.each(function(){var i=this;if(!i.grid){return}if(!g){return}var u=a.isFunction(b[i.p.id].beforeShowForm),s=a.isFunction(b[i.p.id].afterShowForm),t=a.isFunction(b[i.p.id].beforeInitData)?b[i.p.id].beforeInitData:false,p=i.p.id,v={},z=true,m="DelTbl_"+a.jgrid.jqID(p),y,q,x,w,n="DelTbl_"+p,r={themodal:"delmod"+p,modalhead:"delhd"+p,modalcontent:"delcnt"+p,scrollelm:m};b[i.p.id].styleUI=i.p.styleUI||"jQueryUI";if(a.isArray(g)){g=g.join()}if(a("#"+a.jgrid.jqID(r.themodal))[0]!==undefined){if(t){z=t.call(i,a("#"+m));if(z===undefined){z=true}}if(z===false){return}a("#DelData>td","#"+m).text(g);a("#DelError","#"+m).hide();if(b[i.p.id].processing===true){b[i.p.id].processing=false;a("#dData","#"+m).removeClass(c.active)}if(u){b[i.p.id].beforeShowForm.call(i,a("#"+m))}a.jgrid.viewModal("#"+a.jgrid.jqID(r.themodal),{gbox:"#gbox_"+a.jgrid.jqID(p),jqm:b[i.p.id].jqModal,jqM:false,overlay:b[i.p.id].overlay,modal:b[i.p.id].modal});if(s){b[i.p.id].afterShowForm.call(i,a("#"+m))}}else{var l=isNaN(b[i.p.id].dataheight)?b[i.p.id].dataheight:b[i.p.id].dataheight+"px",o=isNaN(e.datawidth)?e.datawidth:e.datawidth+"px",A="<div id='"+n+"' class='formdata' style='width:"+o+";overflow:auto;position:relative;height:"+l+";'>";A+="<table class='DelTable'><tbody>";A+="<tr id='DelError' style='display:none'><td class='"+c.error+"'></td></tr>";A+="<tr id='DelData' style='display:none'><td >"+g+"</td></tr>";A+='<tr><td class="delmsg" style="white-space:pre;">'+b[i.p.id].msg+"</td></tr><tr><td >&#160;</td></tr>";A+="</tbody></table></div>";var k="<a id='dData' class='fm-button "+c.button+"'>"+e.bSubmit+"</a>",j="<a id='eData' class='fm-button "+c.button+"'>"+e.bCancel+"</a>";A+="<table class='EditTable ui-common-table' id='"+m+"_2'><tbody><tr><td><hr class='"+c.content+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton'>"+k+"&#160;"+j+"</td></tr></tbody></table>";e.gbox="#gbox_"+a.jgrid.jqID(p);a.jgrid.createModal(r,A,b[i.p.id],"#gview_"+a.jgrid.jqID(i.p.id),a("#gview_"+a.jgrid.jqID(i.p.id))[0]);if(t){z=t.call(i,a(A));if(z===undefined){z=true}}if(z===false){return}a(".fm-button","#"+m+"_2").hover(function(){a(this).addClass(c.hover)},function(){a(this).removeClass(c.hover)});e.delicon=a.extend([true,"left",h.icon_del],b[i.p.id].delicon);e.cancelicon=a.extend([true,"left",h.icon_cancel],b[i.p.id].cancelicon);if(e.delicon[0]===true){a("#dData","#"+m+"_2").addClass(e.delicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+c.icon_base+" "+e.delicon[2]+"'></span>")}if(e.cancelicon[0]===true){a("#eData","#"+m+"_2").addClass(e.cancelicon[1]==="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='"+c.icon_base+" "+e.cancelicon[2]+"'></span>")}a("#dData","#"+m+"_2").click(function(){var F=[true,""],D,E=a("#DelData>td","#"+m).text();v={};if(a.isFunction(b[i.p.id].onclickSubmit)){v=b[i.p.id].onclickSubmit.call(i,b[i.p.id],E)||{}}if(a.isFunction(b[i.p.id].beforeSubmit)){F=b[i.p.id].beforeSubmit.call(i,E)}if(F[0]&&!b[i.p.id].processing){b[i.p.id].processing=true;x=i.p.prmNames;y=a.extend({},b[i.p.id].delData,v);w=x.oper;y[w]=x.deloper;q=x.id;E=String(E).split(",");if(!E.length){return false}for(D in E){if(E.hasOwnProperty(D)){E[D]=a.jgrid.stripPref(i.p.idPrefix,E[D])}}y[q]=E.join();a(this).addClass(c.active);var B=a.extend({url:b[i.p.id].url||a(i).jqGrid("getGridParam","editurl"),type:b[i.p.id].mtype,data:a.isFunction(b[i.p.id].serializeDelData)?b[i.p.id].serializeDelData.call(i,y):y,complete:function(G,J){var I;a("#dData","#"+m+"_2").removeClass(c.active);if(G.status>=300&&G.status!==304){F[0]=false;if(a.isFunction(b[i.p.id].errorTextFormat)){F[1]=b[i.p.id].errorTextFormat.call(i,G)}else{F[1]=J+" Status: '"+G.statusText+"'. Error code: "+G.status}}else{if(a.isFunction(b[i.p.id].afterSubmit)){F=b[i.p.id].afterSubmit.call(i,G,y)}}if(F[0]===false){a("#DelError>td","#"+m).html(F[1]);a("#DelError","#"+m).show()}else{if(b[i.p.id].reloadAfterSubmit&&i.p.datatype!=="local"){a(i).trigger("reloadGrid")}else{if(i.p.treeGrid===true){try{a(i).jqGrid("delTreeNode",i.p.idPrefix+E[0])}catch(H){}}else{for(I=0;I<E.length;I++){a(i).jqGrid("delRowData",i.p.idPrefix+E[I])}}i.p.selrow=null;i.p.selarrrow=[]}if(a.isFunction(b[i.p.id].afterComplete)){setTimeout(function(){b[i.p.id].afterComplete.call(i,G,E)},500)}}b[i.p.id].processing=false;if(F[0]){a.jgrid.hideModal("#"+a.jgrid.jqID(r.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:e.jqModal,onClose:b[i.p.id].onClose})}}},a.jgrid.ajaxOptions,b[i.p.id].ajaxDelOptions);if(!B.url&&!b[i.p.id].useDataProxy){if(a.isFunction(i.p.dataProxy)){b[i.p.id].useDataProxy=true}else{F[0]=false;F[1]+=" "+a.jgrid.getRegional(i,"errors.nourl")}}if(F[0]){if(b[i.p.id].useDataProxy){var C=i.p.dataProxy.call(i,B,"del_"+i.p.id);if(C===undefined){C=[true,""]}if(C[0]===false){F[0]=false;F[1]=C[1]||"Error deleting the selected row!"}else{a.jgrid.hideModal("#"+a.jgrid.jqID(r.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:e.jqModal,onClose:b[i.p.id].onClose})}}else{if(B.url==="clientArray"){y=B.data;B.complete({status:200,statusText:""},"")}else{a.ajax(B)}}}}if(F[0]===false){a("#DelError>td","#"+m).html(F[1]);a("#DelError","#"+m).show()}return false});a("#eData","#"+m+"_2").click(function(){a.jgrid.hideModal("#"+a.jgrid.jqID(r.themodal),{gb:"#gbox_"+a.jgrid.jqID(p),jqm:b[i.p.id].jqModal,onClose:b[i.p.id].onClose});return false});if(u){b[i.p.id].beforeShowForm.call(i,a("#"+m))}a.jgrid.viewModal("#"+a.jgrid.jqID(r.themodal),{gbox:"#gbox_"+a.jgrid.jqID(p),jqm:b[i.p.id].jqModal,overlay:b[i.p.id].overlay,modal:b[i.p.id].modal});if(s){b[i.p.id].afterShowForm.call(i,a("#"+m))}}if(b[i.p.id].closeOnEscape===true){setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+a.jgrid.jqID(r.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(e,f,i,g,h,j,k){var l=a.jgrid.getRegional(this[0],"nav"),d=this[0].p.styleUI,m=a.jgrid.styleUI[d].navigator,c=a.jgrid.styleUI[d].common;f=a.extend({edit:true,editicon:m.icon_edit_nav,add:true,addicon:m.icon_add_nav,del:true,delicon:m.icon_del_nav,search:true,searchicon:m.icon_search_nav,refresh:true,refreshicon:m.icon_refresh_nav,refreshstate:"firstpage",view:false,viewicon:m.icon_view_nav,position:"left",closeOnEscape:true,beforeRefresh:null,afterRefresh:null,cloneToTop:false,alertwidth:200,alertheight:"auto",alerttop:null,alertleft:null,alertzIndex:null,dropmenu:false,navButtonText:""},l,f||{});return this.each(function(){if(this.p.navGrid){return}var p={themodal:"alertmod_"+this.p.id,modalhead:"alerthd_"+this.p.id,modalcontent:"alertcnt_"+this.p.id},n=this,B,A,u;if(!n.grid||typeof e!=="string"){return}if(!a(n).data("navGrid")){a(n).data("navGrid",f)}u=a(n).data("navGrid");if(n.p.force_regional){u=a.extend(u,l)}if(a("#"+p.themodal)[0]===undefined){if(!u.alerttop&&!u.alertleft){if(window.innerWidth!==undefined){u.alertleft=window.innerWidth;u.alerttop=window.innerHeight}else{if(document.documentElement!==undefined&&document.documentElement.clientWidth!==undefined&&document.documentElement.clientWidth!==0){u.alertleft=document.documentElement.clientWidth;u.alerttop=document.documentElement.clientHeight}else{u.alertleft=1024;u.alerttop=768}}u.alertleft=u.alertleft/2-parseInt(u.alertwidth,10)/2;u.alerttop=u.alerttop/2-25}a.jgrid.createModal(p,"<div>"+u.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+a.jgrid.jqID(n.p.id),jqModal:true,drag:true,resize:true,caption:u.alertcap,top:u.alerttop,left:u.alertleft,width:u.alertwidth,height:u.alertheight,closeOnEscape:u.closeOnEscape,zIndex:u.alertzIndex,styleUI:n.p.styleUI},"#gview_"+a.jgrid.jqID(n.p.id),a("#gbox_"+a.jgrid.jqID(n.p.id))[0],true)}var q=1,s,v=function(){if(!a(this).hasClass(c.disabled)){a(this).addClass(c.hover)}},w=function(){a(this).removeClass(c.hover)};if(u.cloneToTop&&n.p.toppager){q=2}for(s=0;s<q;s++){var z,t=a("<table class='ui-pg-table navtable ui-common-table'><tbody><tr></tr></tbody></table>"),y="<td class='ui-pg-button "+c.disabled+"' style='width:4px;'><span class='ui-separator'></span></td>",x,r;if(s===0){x=e;r=n.p.id;if(x===n.p.toppager){r+="_top";q=1}}else{x=n.p.toppager;r=n.p.id+"_top"}if(n.p.direction==="rtl"){a(t).attr("dir","rtl").css("float","right")}g=g||{};if(u.add){z=a("<td class='ui-pg-button "+c.cornerall+"'></td>");a(z).append("<div class='ui-pg-div'><span class='"+c.icon_base+" "+u.addicon+"'></span>"+u.addtext+"</div>");a("tr",t).append(z);a(z,t).attr({title:u.addtitle||"",id:g.id||"add_"+r}).click(function(){if(!a(this).hasClass(c.disabled)){if(a.isFunction(u.addfunc)){u.addfunc.call(n)}else{a(n).jqGrid("editGridRow","new",g)}}return false}).hover(v,w);z=null}i=i||{};if(u.edit){z=a("<td class='ui-pg-button "+c.cornerall+"'></td>");a(z).append("<div class='ui-pg-div'><span class='"+c.icon_base+" "+u.editicon+"'></span>"+u.edittext+"</div>");a("tr",t).append(z);a(z,t).attr({title:u.edittitle||"",id:i.id||"edit_"+r}).click(function(){if(!a(this).hasClass(c.disabled)){var o=n.p.selrow;if(o){if(a.isFunction(u.editfunc)){u.editfunc.call(n,o)}else{a(n).jqGrid("editGridRow",o,i)}}else{a.jgrid.viewModal("#"+p.themodal,{gbox:"#gbox_"+a.jgrid.jqID(n.p.id),jqm:true});a("#jqg_alrt").focus()}}return false}).hover(v,w);z=null}k=k||{};if(u.view){z=a("<td class='ui-pg-button "+c.cornerall+"'></td>");a(z).append("<div class='ui-pg-div'><span class='"+c.icon_base+" "+u.viewicon+"'></span>"+u.viewtext+"</div>");a("tr",t).append(z);a(z,t).attr({title:u.viewtitle||"",id:k.id||"view_"+r}).click(function(){if(!a(this).hasClass(c.disabled)){var o=n.p.selrow;if(o){if(a.isFunction(u.viewfunc)){u.viewfunc.call(n,o)}else{a(n).jqGrid("viewGridRow",o,k)}}else{a.jgrid.viewModal("#"+p.themodal,{gbox:"#gbox_"+a.jgrid.jqID(n.p.id),jqm:true});a("#jqg_alrt").focus()}}return false}).hover(v,w);z=null}h=h||{};if(u.del){z=a("<td class='ui-pg-button "+c.cornerall+"'></td>");a(z).append("<div class='ui-pg-div'><span class='"+c.icon_base+" "+u.delicon+"'></span>"+u.deltext+"</div>");a("tr",t).append(z);a(z,t).attr({title:u.deltitle||"",id:h.id||"del_"+r}).click(function(){if(!a(this).hasClass(c.disabled)){var o;if(n.p.multiselect){o=n.p.selarrrow;if(o.length===0){o=null}}else{o=n.p.selrow}if(o){if(a.isFunction(u.delfunc)){u.delfunc.call(n,o)}else{a(n).jqGrid("delGridRow",o,h)}}else{a.jgrid.viewModal("#"+p.themodal,{gbox:"#gbox_"+a.jgrid.jqID(n.p.id),jqm:true});a("#jqg_alrt").focus()}}return false}).hover(v,w);z=null}if(u.add||u.edit||u.del||u.view){a("tr",t).append(y)}j=j||{};if(u.search){z=a("<td class='ui-pg-button "+c.cornerall+"'></td>");a(z).append("<div class='ui-pg-div'><span class='"+c.icon_base+" "+u.searchicon+"'></span>"+u.searchtext+"</div>");a("tr",t).append(z);a(z,t).attr({title:u.searchtitle||"",id:j.id||"search_"+r}).click(function(){if(!a(this).hasClass(c.disabled)){if(a.isFunction(u.searchfunc)){u.searchfunc.call(n,j)}else{a(n).jqGrid("searchGrid",j)}}return false}).hover(v,w);if(j.showOnLoad&&j.showOnLoad===true){a(z,t).click()}z=null}if(u.refresh){z=a("<td class='ui-pg-button "+c.cornerall+"'></td>");a(z).append("<div class='ui-pg-div'><span class='"+c.icon_base+" "+u.refreshicon+"'></span>"+u.refreshtext+"</div>");a("tr",t).append(z);a(z,t).attr({title:u.refreshtitle||"",id:"refresh_"+r}).click(function(){if(!a(this).hasClass(c.disabled)){if(a.isFunction(u.beforeRefresh)){u.beforeRefresh.call(n)}n.p.search=false;n.p.resetsearch=true;try{if(u.refreshstate!=="currentfilter"){var D=n.p.id;n.p.postData.filters="";try{a("#fbox_"+a.jgrid.jqID(D)).jqFilter("resetFilter")}catch(C){}if(a.isFunction(n.clearToolbar)){n.clearToolbar.call(n,false)}}}catch(o){}switch(u.refreshstate){case"firstpage":a(n).trigger("reloadGrid",[{page:1}]);break;case"current":case"currentfilter":a(n).trigger("reloadGrid",[{current:true}]);break}if(a.isFunction(u.afterRefresh)){u.afterRefresh.call(n)}}return false}).hover(v,w);z=null}A=a(".ui-jqgrid").css("font-size")||"11px";a("body").append("<div id='testpg2' class='ui-jqgrid "+a.jgrid.styleUI[d].base.entrieBox+"' style='font-size:"+A+";visibility:hidden;' ></div>");B=a(t).clone().appendTo("#testpg2").width();a("#testpg2").remove();if(n.p._nvtd){if(u.dropmenu){t=null;a(n).jqGrid("_buildNavMenu",x,r,f,i,g,h,j,k)}else{if(B>n.p._nvtd[0]){if(n.p.responsive){t=null;a(n).jqGrid("_buildNavMenu",x,r,f,i,g,h,j,k)}else{a(x+"_"+u.position,x).append(t).width(B)}n.p._nvtd[0]=B}else{a(x+"_"+u.position,x).append(t)}}n.p._nvtd[1]=B}n.p.navGrid=true}if(n.p.storeNavOptions){n.p.navOptions=u;n.p.editOptions=i;n.p.addOptions=g;n.p.delOptions=h;n.p.searchOptions=j;n.p.viewOptions=k;n.p.navButtons=[]}})},navButtonAdd:function(d,e){var c=this[0].p.styleUI,f=a.jgrid.styleUI[c].navigator;e=a.extend({caption:"newButton",title:"",buttonicon:f.icon_newbutton_nav,onClickButton:null,position:"last",cursor:"pointer",internal:false},e||{});return this.each(function(){if(!this.grid){return}if(typeof d==="string"&&d.indexOf("#")!==0){d="#"+a.jgrid.jqID(d)}var k=a(".navtable",d)[0],g=this,i=a.jgrid.styleUI[c].common.disabled,l=a.jgrid.styleUI[c].common.hover,h=a.jgrid.styleUI[c].common.cornerall,m=a.jgrid.styleUI[c].common.icon_base;if(g.p.storeNavOptions&&!e.internal){g.p.navButtons.push([d,e])}if(k){if(e.id&&a("#"+a.jgrid.jqID(e.id),k)[0]!==undefined){return}var p=a("<td></td>");if(e.buttonicon.toString().toUpperCase()==="NONE"){a(p).addClass("ui-pg-button "+h).append("<div class='ui-pg-div'>"+e.caption+"</div>")}else{a(p).addClass("ui-pg-button "+h).append("<div class='ui-pg-div'><span class='"+m+" "+e.buttonicon+"'></span>"+e.caption+"</div>")}if(e.id){a(p).attr("id",e.id)}if(e.position==="first"){if(k.rows[0].cells.length===0){a("tr",k).append(p)}else{a("tr td:eq(0)",k).before(p)}}else{a("tr",k).append(p)}a(p,k).attr("title",e.title||"").click(function(q){if(!a(this).hasClass(i)){if(a.isFunction(e.onClickButton)){e.onClickButton.call(g,q)}}return false}).hover(function(){if(!a(this).hasClass(i)){a(this).addClass(l)}},function(){a(this).removeClass(l)})}else{k=a(".dropdownmenu",d)[0];if(k){var n=a(k).val(),j=e.id||a.jgrid.randId(),o=a('<li class="ui-menu-item" role="presentation"><a class="'+h+' g-menu-item" tabindex="0" role="menuitem" id="'+j+'">'+(e.caption||e.title)+"</a></li>");if(n){if(e.position==="first"){a("#"+n).prepend(o)}else{a("#"+n).append(o)}a(o).on("click",function(q){if(!a(this).hasClass(i)){a("#"+n).hide();if(a.isFunction(e.onClickButton)){e.onClickButton.call(g,q)}}return false}).find("a").hover(function(){if(!a(this).hasClass(i)){a(this).addClass(l)}},function(){a(this).removeClass(l)})}}}})},navSeparatorAdd:function(e,f){var d=this[0].p.styleUI,c=a.jgrid.styleUI[d].common;f=a.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},f||{});return this.each(function(){if(!this.grid){return}if(typeof e==="string"&&e.indexOf("#")!==0){e="#"+a.jgrid.jqID(e)}var g=a(".navtable",e)[0],i,h;if(this.p.storeNavOptions){this.p.navButtons.push([e,f])}if(g){i="<td class='ui-pg-button "+c.disabled+"' style='width:4px;'><span class='"+f.sepclass+"'></span>"+f.sepcontent+"</td>";if(f.position==="first"){if(g.rows[0].cells.length===0){a("tr",g).append(i)}else{a("tr td:eq(0)",g).before(i)}}else{a("tr",g).append(i)}}else{g=a(".dropdownmenu",e)[0];i="<li class='ui-menu-item "+c.disabled+"' style='width:100%' role='presentation'><hr class='ui-separator-li'></li>";if(g){h=a(g).val();if(h){if(f.position==="first"){a("#"+h).prepend(i)}else{a("#"+h).append(i)}}}}})},_buildNavMenu:function(c,d,e,h,f,g,i,j){return this.each(function(){var k=this,t=a.jgrid.getRegional(k,"nav"),r=k.p.styleUI,u=a.jgrid.styleUI[r].navigator,p=a.jgrid.styleUI[r].filter,q=a.jgrid.styleUI[r].common,s="form_menu_"+a.jgrid.randId(),o=e.navButtonText?e.navButtonText:t.selectcaption||"Actions",m="<button class='dropdownmenu "+q.button+"' value='"+s+"'>"+o+"</button>";a(c+"_"+e.position,c).append(m);var n={themodal:"alertmod_"+this.p.id,modalhead:"alerthd_"+this.p.id,modalcontent:"alertcnt_"+this.p.id},l=function(){var w=a(".ui-jqgrid-view").css("font-size")||"11px",v,x,y=a('<ul id="'+s+'" class="ui-nav-menu modal-content" role="menu" tabindex="0" style="display:none;font-size:'+w+'"></ul>');if(e.add){f=f||{};v=f.id||"add_"+d;x=a('<li class="ui-menu-item" role="presentation"><a class="'+q.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+v+'">'+(e.addtext||e.addtitle)+"</a></li>").click(function(){if(!a(this).hasClass(q.disabled)){if(a.isFunction(e.addfunc)){e.addfunc.call(k)}else{a(k).jqGrid("editGridRow","new",f)}a(y).hide()}return false});a(y).append(x)}if(e.edit){h=h||{};v=h.id||"edit_"+d;x=a('<li class="ui-menu-item" role="presentation"><a class="'+q.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+v+'">'+(e.edittext||e.edittitle)+"</a></li>").click(function(){if(!a(this).hasClass(q.disabled)){var z=k.p.selrow;if(z){if(a.isFunction(e.editfunc)){e.editfunc.call(k,z)}else{a(k).jqGrid("editGridRow",z,h)}}else{a.jgrid.viewModal("#"+n.themodal,{gbox:"#gbox_"+a.jgrid.jqID(k.p.id),jqm:true});a("#jqg_alrt").focus()}a(y).hide()}return false});a(y).append(x)}if(e.view){j=j||{};v=j.id||"view_"+d;x=a('<li class="ui-menu-item" role="presentation"><a class="'+q.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+v+'">'+(e.viewtext||e.viewtitle)+"</a></li>").click(function(){if(!a(this).hasClass(q.disabled)){var z=k.p.selrow;if(z){if(a.isFunction(e.editfunc)){e.viewfunc.call(k,z)}else{a(k).jqGrid("viewGridRow",z,j)}}else{a.jgrid.viewModal("#"+n.themodal,{gbox:"#gbox_"+a.jgrid.jqID(k.p.id),jqm:true});a("#jqg_alrt").focus()}a(y).hide()}return false});a(y).append(x)}if(e.del){g=g||{};v=g.id||"del_"+d;x=a('<li class="ui-menu-item" role="presentation"><a class="'+q.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+v+'">'+(e.deltext||e.deltitle)+"</a></li>").click(function(){if(!a(this).hasClass(q.disabled)){var z;if(k.p.multiselect){z=k.p.selarrrow;if(z.length===0){z=null}}else{z=k.p.selrow}if(z){if(a.isFunction(e.delfunc)){e.delfunc.call(k,z)}else{a(k).jqGrid("delGridRow",z,g)}}else{a.jgrid.viewModal("#"+n.themodal,{gbox:"#gbox_"+a.jgrid.jqID(k.p.id),jqm:true});a("#jqg_alrt").focus()}a(y).hide()}return false});a(y).append(x)}if(e.add||e.edit||e.del||e.view){a(y).append("<li class='ui-menu-item "+q.disabled+"' style='width:100%' role='presentation'><hr class='ui-separator-li'></li>")}if(e.search){i=i||{};v=i.id||"search_"+d;x=a('<li class="ui-menu-item" role="presentation"><a class="'+q.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+v+'">'+(e.searchtext||e.searchtitle)+"</a></li>").click(function(){if(!a(this).hasClass(q.disabled)){if(a.isFunction(e.searchfunc)){e.searchfunc.call(k,i)}else{a(k).jqGrid("searchGrid",i)}a(y).hide()}return false});a(y).append(x);if(i.showOnLoad&&i.showOnLoad===true){a(x).click()}}if(e.refresh){v=i.id||"search_"+d;x=a('<li class="ui-menu-item" role="presentation"><a class="'+q.cornerall+' g-menu-item" tabindex="0" role="menuitem" id="'+v+'">'+(e.refreshtext||e.refreshtitle)+"</a></li>").click(function(){if(!a(this).hasClass(q.disabled)){if(a.isFunction(e.beforeRefresh)){e.beforeRefresh.call(k)}k.p.search=false;k.p.resetsearch=true;try{if(e.refreshstate!=="currentfilter"){var B=k.p.id;k.p.postData.filters="";try{a("#fbox_"+a.jgrid.jqID(B)).jqFilter("resetFilter")}catch(A){}if(a.isFunction(k.clearToolbar)){k.clearToolbar.call(k,false)}}}catch(z){}switch(e.refreshstate){case"firstpage":a(k).trigger("reloadGrid",[{page:1}]);break;case"current":case"currentfilter":a(k).trigger("reloadGrid",[{current:true}]);break}if(a.isFunction(e.afterRefresh)){e.afterRefresh.call(k)}a(y).hide()}return false});a(y).append(x)}a(y).hide();a("body").append(y);a("#"+s).addClass("ui-menu "+p.menu_widget);a("#"+s+" > li > a").hover(function(){a(this).addClass(q.hover)},function(){a(this).removeClass(q.hover)})};l();a(".dropdownmenu",c+"_"+e.position).on("click",function(w){var y=a(this).offset(),x=(y.left),z=parseInt(y.top),v=a(this).val();a("#"+v).show().css({top:z-(a("#"+v).height()+10)+"px",left:x+"px"});w.stopPropagation()});a("body").on("click",function(v){if(!a(v.target).hasClass("dropdownmenu")){a("#"+s).hide()}})})},GridToForm:function(d,c){return this.each(function(){var e=this,f;if(!e.grid){return}var g=a(e).jqGrid("getRowData",d);if(g){for(f in g){if(g.hasOwnProperty(f)){if(a("[name="+a.jgrid.jqID(f)+"]",c).is("input:radio")||a("[name="+a.jgrid.jqID(f)+"]",c).is("input:checkbox")){a("[name="+a.jgrid.jqID(f)+"]",c).each(function(){if(a(this).val()==g[f]){a(this)[e.p.useProp?"prop":"attr"]("checked",true)}else{a(this)[e.p.useProp?"prop":"attr"]("checked",false)}})}else{a("[name="+a.jgrid.jqID(f)+"]",c).val(g[f])}}}}})},FormToGrid:function(f,c,d,e){return this.each(function(){var g=this;if(!g.grid){return}if(!d){d="set"}if(!e){e="first"}var h=a(c).serializeArray();var i={};a.each(h,function(k,j){i[j.name]=j.value});if(d==="add"){a(g).jqGrid("addRowData",f,i,e)}else{if(d==="set"){a(g).jqGrid("setRowData",f,i)}}})}})}));