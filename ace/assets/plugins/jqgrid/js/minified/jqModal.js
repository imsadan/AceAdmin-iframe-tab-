!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):b(jQuery)}(function(k){k.fn.jqm=function(a){var b={overlay:50,closeoverlay:!0,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:o,ajaxText:"",target:o,modal:o,toTop:o,onShow:o,onHide:o,onLoad:o};return this.each(function(){return this._jqm?m[this._jqm].c=k.extend({},m[this._jqm].c,a):(l++,this._jqm=l,m[l]={c:k.extend(b,k.jqm.params,a),a:o,w:k(this).addClass("jqmID"+l),s:l},void (b.trigger&&k(this).jqmAddTrigger(b.trigger)))})},k.fn.jqmAddClose=function(b){return t(this,b,"jqmHide")},k.fn.jqmAddTrigger=function(b){return t(this,b,"jqmShow")},k.fn.jqmShow=function(a){return this.each(function(){k.jqm.open(this._jqm,a)})},k.fn.jqmHide=function(a){return this.each(function(){k.jqm.close(this._jqm,a)})},k.jqm={hash:{},open:function(a,c){var d=m[a],e=d.c,f="."+e.closeClass,h=parseInt(d.w.css("z-index"));h=h>0?h:3000;var u=k("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":h-1,opacity:e.overlay/100});if(d.a){return o}if(d.t=c,d.a=!0,d.w.css("z-index",h),e.modal?(n[0]||setTimeout(function(){new r("bind")},1),n.push(a)):e.overlay>0?e.closeoverlay&&d.w.jqmAddClose(u):u=o,d.o=u?u.addClass(e.overlayClass).prependTo("body"):o,e.ajax){var v=e.target||d.w,w=e.ajax;v="string"==typeof v?k(v,d.w):k(v),w="@"===w.substr(0,1)?k(c).attr(w.substring(1)):w,v.html(e.ajaxText).load(w,function(){e.onLoad&&e.onLoad.call(this,d),f&&d.w.jqmAddClose(k(f,d.w)),p(d)})}else{f&&d.w.jqmAddClose(k(f,d.w))}return e.toTop&&d.o&&d.w.before('<span id="jqmP'+d.w[0]._jqm+'"></span>').insertAfter(d.o),e.onShow?e.onShow(d):d.w.show(),p(d),o},close:function(a){var c=m[a];return c.a?(c.a=o,n[0]&&(n.pop(),n[0]||new r("unbind")),c.c.toTop&&c.o&&k("#jqmP"+c.w[0]._jqm).after(c.w).remove(),c.c.onHide?c.c.onHide(c):(c.w.hide(),c.o&&c.o.remove()),o):o},params:{}};var l=0,m=k.jqm.hash,n=[],o=!1,p=function(b){void 0===b.c.focusField&&(b.c.focusField=0),b.c.focusField>=0&&q(b)},q=function(a){try{k(":input:visible",a.w)[parseInt(a.c.focusField,10)].focus()}catch(d){}},r=function(a){k(document)[a]("keypress",s)[a]("keydown",s)[a]("mousedown",s)},s=function(a){var c=m[n[n.length-1]],d=!k(a.target).parents(".jqmID"+c.s)[0];return d&&(k(".jqmID"+c.s).each(function(){var b=k(this),e=b.offset();return e.top<=a.pageY&&a.pageY<=e.top+b.height()&&e.left<=a.pageX&&a.pageX<=e.left+b.width()?(d=!1,!1):void 0}),q(c)),!d},t=function(a,c,e){return a.each(function(){var d=this._jqm;k(c).each(function(){this[e]||(this[e]=[],k(this).click(function(){for(var f in {jqmShow:1,jqmHide:1}){for(var g in this[f]){m[this[f][g]]&&m[this[f][g]].w[f](this)}}return o})),this[e].push(d)})})}});